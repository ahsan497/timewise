<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>TimeWise Settings</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      padding: 40px 20px;
      color: #333;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 32px;
    }
    
    h1 {
      font-size: 28px;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .subtitle {
      color: #666;
      margin-bottom: 32px;
    }
    
    .section {
      margin-bottom: 32px;
      padding-bottom: 32px;
      border-bottom: 1px solid #e0e0e0;
    }
    
    .section:last-child {
      border-bottom: none;
    }
    
    h2 {
      font-size: 18px;
      color: #2c3e50;
      margin-bottom: 16px;
    }
    
    .input-group {
      margin-bottom: 16px;
    }
    
    label {
      display: block;
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 6px;
      color: #555;
    }
    
    input[type="text"],
    input[type="number"] {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      font-family: inherit;
    }
    
    input:focus {
      outline: none;
      border-color: #5a67d8;
    }
    
    .btn {
      background: #5a67d8;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: background 0.2s;
    }
    
    .btn:hover {
      background: #4c51bf;
    }
    
    .btn-secondary {
      background: #e0e0e0;
      color: #333;
    }
    
    .btn-secondary:hover {
      background: #d0d0d0;
    }
    
    .btn-danger {
      background: #ef4444;
    }
    
    .btn-danger:hover {
      background: #dc2626;
    }
    
    .limit-list {
      margin-top: 16px;
    }
    
    .limit-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 6px;
      margin-bottom: 8px;
    }
    
    .limit-info {
      flex: 1;
    }
    
    .limit-domain {
      font-weight: 500;
      color: #2c3e50;
    }
    
    .limit-time {
      font-size: 13px;
      color: #666;
      margin-top: 2px;
    }
    
    .remove-btn {
      background: none;
      border: none;
      color: #ef4444;
      cursor: pointer;
      font-size: 20px;
      padding: 0 8px;
    }
    
    .empty-state {
      text-align: center;
      color: #888;
      padding: 24px;
      font-size: 14px;
    }
    
    .add-limit-form {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }
    
    .add-limit-form input {
      flex: 1;
    }
    
    /* FIXED: Add scrollable container for history table */
    .history-table-container {
      max-height: 500px;
      overflow-y: auto;
      margin-top: 16px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
    }
    
    .history-table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .history-table th,
    .history-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #e0e0e0;
    }
    
    .history-table th {
      background: #f8f9fa;
      font-weight: 600;
      font-size: 13px;
      color: #666;
      text-transform: uppercase;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    .history-table td {
      font-size: 14px;
    }
    
    .history-table tbody tr:last-child td {
      border-bottom: none;
    }
    
    .success-message {
      background: #10b981;
      color: white;
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 16px;
      display: none;
    }
    
    .success-message.show {
      display: block;
    }
    
    .date-filter {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
      align-items: flex-end;
    }
    
    .date-filter > div {
      flex: 1;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>âš™ï¸ TimeWise Settings</h1>
    <p class="subtitle">Configure your focus tracking and reminders</p>
    
    <div class="success-message" id="successMessage">
      âœ“ Settings saved successfully!
    </div>
    
    <!-- Time Limits Section -->
    <div class="section">
      <h2>â° Daily Time Limits & Goals</h2>
      <p style="color: #666; font-size: 14px; margin-bottom: 16px;">
        Set friendly time limits for websites. You'll receive a gentle reminder when you reach your limit.
      </p>
      
      <div class="add-limit-form">
        <input 
          type="text" 
          id="limitDomain" 
          placeholder="Enter domain (e.g., youtube.com)"
        >
        <input 
          type="number" 
          id="limitMinutes" 
          placeholder="Minutes"
          min="1"
          style="max-width: 120px;"
        >
        <button class="btn" id="addLimitBtn">Add Limit</button>
      </div>
      
      <div class="limit-list" id="limitList"></div>
      
      <div style="margin-top: 24px; padding: 16px; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #5a67d8;">
        <h3 style="font-size: 14px; margin-bottom: 8px; color: #2c3e50;">ğŸ“Š Daily Productivity Goal</h3>
        <p style="font-size: 13px; color: #666; margin-bottom: 12px;">
          Set a daily goal for total productive time across all sites
        </p>
        <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
          <input 
            type="number" 
            id="dailyGoalMinutes" 
            placeholder="Minutes"
            min="30"
            max="480"
            style="max-width: 100px; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"
          >
          <span style="color: #666;">minutes per day</span>
          <button class="btn btn-sm" id="setGoalBtn">Set Goal</button>
        </div>
        <p style="font-size: 11px; color: #888; margin-top: 8px; font-style: italic;">
          ğŸ’¡ Tip: Clear the input and click "Set Goal" to remove your goal
        </p>
        <div id="goalStatus" style="margin-top: 12px; font-size: 13px; color: #666;"></div>
      </div>
    </div>
    
    <!-- History Section -->
    <div class="section">
      <h2>ğŸ“Š Focus History</h2>
      
      <div class="date-filter">
        <div>
          <label>Date Range</label>
          <input type="date" id="startDate">
        </div>
        <div>
          <label>&nbsp;</label>
          <input type="date" id="endDate">
        </div>
        <button class="btn" id="loadHistoryBtn">Load History</button>
      </div>
      
      <div class="history-table-container">
        <table class="history-table">
          <thead>
            <tr>
              <th>Website</th>
              <th>Date & Time</th>
              <th>Time Spent</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="historyBody">
            <tr>
              <td colspan="4" class="empty-state">Select a date range to view history</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- Data Management Section -->
    <div class="section">
      <h2>ğŸ—„ï¸ Data Management</h2>
      <p style="color: #666; font-size: 14px; margin-bottom: 16px;">
        Your data is stored locally in your browser and never leaves your device.
      </p>
      
      <div style="display: flex; gap: 12px; margin-bottom: 16px;">
        <button class="btn btn-secondary" id="exportBtn">Export Data</button>
        <button class="btn btn-secondary" id="importBtn">Import Data</button>
        <button class="btn btn-danger" id="clearBtn">Clear All Data</button>
      </div>
      
      <input type="file" id="importFile" accept=".json" style="display: none;">
      
      <div style="margin-top: 20px; padding: 16px; background: #f8f9fa; border-radius: 8px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
          <strong>Current Storage Usage:</strong>
          <span id="storageSize" style="font-size: 18px; color: #5a67d8;">Calculating...</span>
        </div>
        <div style="height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden;">
          <div id="storageBar" style="height: 100%; background: #5a67d8; width: 0%; transition: width 0.3s;"></div>
        </div>
        <div style="font-size: 12px; color: #666; margin-top: 4px;">
          Limit: 10 MB â€¢ Automatic cleanup keeps last 365 days
        </div>
      </div>
    </div>
    
    <!-- No-Track List Section -->
    <div class="section">
      <h2>ğŸš« No-Track List</h2>
      <p style="color: #666; font-size: 14px; margin-bottom: 16px;">
        Add domains or URLs that should never be tracked. Useful for work sites, banking, etc.
      </p>
      
      <div class="add-limit-form">
        <input 
          type="text" 
          id="noTrackInput" 
          placeholder="Enter domain (e.g., bank.com) or full URL"
        >
        <button class="btn" id="addNoTrackBtn">Add to No-Track</button>
      </div>
      
      <div class="limit-list" id="noTrackList"></div>
    </div>
    
    <!-- Storage Cleanup Section -->
    <div class="section">
      <h2>ğŸ§¹ Storage Cleanup</h2>
      
      <div class="input-group">
        <label>Delete time data older than:</label>
        <select id="cleanupMonths" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; margin-right: 8px;">
          <option value="1">1 month</option>
          <option value="3">3 months</option>
          <option value="6" selected>6 months</option>
          <option value="12">1 year</option>
        </select>
        <button class="btn btn-secondary" id="cleanupTimeBtn">Clean Up Time Data</button>
      </div>
      
      <div class="input-group" style="margin-top: 12px;">
        <label>Keep only last X notes per site:</label>
        <input type="number" id="notesLimit" value="50" min="1" max="100" style="width: 80px; padding: 8px; border: 1px solid #ddd; border-radius: 4px; margin-right: 8px;">
        <button class="btn btn-secondary" id="cleanupNotesBtn">Clean Up Notes</button>
      </div>
      
      <p style="font-size: 12px; color: #888; margin-top: 12px; font-style: italic;">
        ğŸ’¡ Tip: TimeWise automatically cleans data older than 1 year every week. Manual cleanup is rarely needed.
      </p>
    </div>
  </div>
  
  <script src="settings.js"></script>
</body>
</html>